{"ast":null,"code":"import { authCodeFlowConfig } from \"../config/auth-config\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../service/greeting-service.service\";\nimport * as i2 from \"angular-oauth2-oidc\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nfunction AppComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 1)(2, \"h1\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"h2\");\n    i0.ɵɵtext(5, \"User\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"h2\");\n    i0.ɵɵtext(9, \"Id-Token\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"h2\");\n    i0.ɵɵtext(13, \"Access Token\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"p\")(17, \"button\", 2);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_0_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.refresh());\n    });\n    i0.ɵɵtext(18, \"Refresh\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Welcome to \", ctx_r0.title, \"!\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.userName);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.idToken);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.accessToken);\n  }\n}\nclass AppComponent {\n  constructor(greetingService, oauthService, router) {\n    this.greetingService = greetingService;\n    this.oauthService = oauthService;\n    this.router = router;\n    this.title = 'demo-angular';\n    this.configureCodeFlow();\n  }\n  configureCodeFlow() {\n    this.oauthService.configure(authCodeFlowConfig);\n    this.oauthService.loadDiscoveryDocumentAndTryLogin();\n    this.oauthService.events.subscribe(e => {\n      console.log('event received:[', e.type, ']');\n      if (e.type === 'token_received') {\n        this.oauthService.loadUserProfile();\n      }\n    });\n    this.oauthService.setupAutomaticSilentRefresh();\n  }\n  getGreeting() {\n    return this.greetingService.getGreeting();\n  }\n  get userName() {\n    const claims = this.oauthService.getIdentityClaims();\n    if (!claims) return '';\n    return claims['given_name'];\n  }\n  get idToken() {\n    return this.oauthService.getIdToken();\n  }\n  get accessToken() {\n    return this.oauthService.getAccessToken();\n  }\n  refresh() {\n    this.oauthService.refreshToken();\n  }\n}\nAppComponent.ɵfac = function AppComponent_Factory(t) {\n  return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.GreetingServiceService), i0.ɵɵdirectiveInject(i2.OAuthService), i0.ɵɵdirectiveInject(i3.Router));\n};\nAppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AppComponent,\n  selectors: [[\"app-root\"]],\n  decls: 2,\n  vars: 1,\n  consts: [[4, \"ngIf\"], [2, \"text-align\", \"center\"], [3, \"click\"]],\n  template: function AppComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, AppComponent_div_0_Template, 19, 4, \"div\", 0);\n      i0.ɵɵelement(1, \"router-outlet\");\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.idToken);\n    }\n  },\n  dependencies: [i4.NgIf, i3.RouterOutlet],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});\nexport { AppComponent };","map":{"version":3,"names":["authCodeFlowConfig","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","AppComponent_div_0_Template_button_click_17_listener","ɵɵrestoreView","_r2","ctx_r1","ɵɵnextContext","ɵɵresetView","refresh","ɵɵadvance","ɵɵtextInterpolate1","ctx_r0","title","ɵɵtextInterpolate","userName","idToken","accessToken","AppComponent","constructor","greetingService","oauthService","router","configureCodeFlow","configure","loadDiscoveryDocumentAndTryLogin","events","subscribe","e","console","log","type","loadUserProfile","setupAutomaticSilentRefresh","getGreeting","claims","getIdentityClaims","getIdToken","getAccessToken","refreshToken","ɵɵdirectiveInject","i1","GreetingServiceService","i2","OAuthService","i3","Router","selectors","decls","vars","consts","template","AppComponent_Template","rf","ctx","ɵɵtemplate","AppComponent_div_0_Template","ɵɵelement","ɵɵproperty"],"sources":["/Users/fenggu/Documents/git/Template/demo-angular/src/app/app.component.ts","/Users/fenggu/Documents/git/Template/demo-angular/src/app/app.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport {GreetingServiceService} from \"../service/greeting-service.service\";\nimport {Router} from \"@angular/router\";\nimport {OAuthService, OAuthEvent} from \"angular-oauth2-oidc\";\nimport {authCodeFlowConfig} from \"../config/auth-config\";\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n  title = 'demo-angular';\n\n  constructor(private greetingService: GreetingServiceService,\n              private oauthService: OAuthService,\n    private router: Router) {\n    this.configureCodeFlow();\n  }\n\n\n\n  private configureCodeFlow() {\n    this.oauthService.configure(authCodeFlowConfig);\n    this.oauthService.loadDiscoveryDocumentAndTryLogin();\n\n    this.oauthService.events\n      .subscribe((e: OAuthEvent) => {\n        console.log('event received:[', e.type,']');\n          if (e.type === 'token_received') {\n            this.oauthService.loadUserProfile();\n          }\n      }\n        );\n    this.oauthService.setupAutomaticSilentRefresh();\n  }\n\n\n  getGreeting() {\n    return this.greetingService.getGreeting();\n  }\n\n  get userName(): string {\n    const claims = this.oauthService.getIdentityClaims();\n    if (!claims) return '';\n    return claims['given_name'];\n  }\n\n  get idToken(): string {\n    return this.oauthService.getIdToken();\n  }\n\n  get accessToken(): string {\n    return this.oauthService.getAccessToken();\n  }\n\n  refresh() {\n    this.oauthService.refreshToken();\n  }\n}\n\n\n","<!--The content below is only a placeholder and can be replaced.-->\n<div *ngIf=\"idToken\">\n  <div style=\"text-align:center\">\n    <h1>Welcome to {{ title }}!</h1>\n  </div>\n\n  <h2>User</h2>\n  <p>{{ userName }}</p>\n\n  <h2>Id-Token</h2>\n  <p>{{ idToken }}</p>\n\n  <h2>Access Token</h2>\n  <p>{{ accessToken }}</p>\n\n  <p>\n    <button (click)=\"refresh()\">Refresh</button>\n  </p>\n</div>\n<router-outlet></router-outlet>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}